<!DOCTYPE html>
<html>

<head>
    <title>Topper Calculator</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>

<body>

    <nav class="navbar">
        <div class="nav-title">PlatStat</div>
        <div class="nav-links">
            <a href="/">Home</a>
        </div>
    </nav>

    <div class="card">
        <h2>Topper Calculator</h2>

        <!-- DEBUG BANNER (Temporary) -->
        {% if debug_info %}
        <div
            style="background:#0f172a; color:#22d3ee; padding:15px; margin-bottom:20px; border-radius:8px; font-family:monospace; font-size:13px; overflow-x:auto;">
            <strong>DEBUG INFO:</strong><br>
            {% for k, v in debug_info.items() %}
            <span style="color:#fbbf24;">{{ k }}</span>: <span style="color:#e2e8f0;">{{ v }}</span><br>
            {% endfor %}
        </div>
        {% endif %}

        <!-- ERROR MESSAGE -->
        {% if error %}
        <div style="background:#fee2e2;color:#991b1b;padding:12px;border-radius:8px;margin-bottom:15px;">
            {{ error }}
        </div>
        {% endif %}

        <form method="POST" enctype="multipart/form-data">

            <div class="form-group">
                <label>Select Platform</label>
                <select name="platform" required>
                    <option value="">Choose a platform...</option>
                    <option value="leetcode">LeetCode</option>
                    <option value="codeforces">Codeforces</option>
                    <option value="codechef">CodeChef</option>
                </select>
            </div>

            <div class="form-group" style="margin-top:15px;">
                <label>Select Month</label>
                <select name="month" required>
                    <option value="1">January</option>
                    <option value="2">February</option>
                    <option value="3">March</option>
                    <option value="4">April</option>
                    <option value="5">May</option>
                    <option value="6">June</option>
                    <option value="7">July</option>
                    <option value="8">August</option>
                    <option value="9">September</option>
                    <option value="10">October</option>
                    <option value="11">November</option>
                    <option value="12">December</option>
                </select>
            </div>

            <div class="form-group" style="margin-top:15px;">
                <label>Upload Statistics File (.xlsx)</label>
                <input type="file" name="sheet" accept=".xlsx,.xls" required>
            </div>

            <button type="submit" style="margin-top:20px;">Find Top 5</button>

        </form>
    </div>


    <!-- RESULT SECTION -->
    {% if result is not none %}

    <div class="wide-card" style="margin-top:40px;">
        <h3>Top 5 Students</h3>

        {% if result|length == 0 %}
        <p style="color:#64748b;">No records found for selected month.</p>
        {% else %}

        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        {% for k in result[0].keys() %}
                        <th>{{ k }}</th>
                        {% endfor %}
                    </tr>
                </thead>

                <tbody>
                    {% for row in result %}
                    <tr>
                        {% for v in row.values() %}
                        <td>{{ v }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>

        {% endif %}
    </div>

    {% endif %}

</body>

</html>